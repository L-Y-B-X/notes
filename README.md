# notes
# ESP32-C3 + 锂电池供电方案工程总结

## 1. 系统目标
- 单节锂电池供电（3.0–4.2V）
- USB-C 充电
- ESP32-C3 长时间 Wi-Fi 工作
- 5 颗 WS2812 LED
- 支持边充边用（USB 插拔不重启）

---

## 2. 负载电流评估

| 模块 | 电流特性 |
|----|----|
| ESP32-C3 Wi-Fi | 300–500 mA 峰值 |
| WS2812 ×5 | ~300 mA（满亮） |
| 系统瞬态 | 可接近 800–1000 mA |

结论：  
**3.3V 电源必须按 ≥1A 设计，且能承受瞬态冲击。**

---

## 3. 锂电池系统功能划分（工程视角）

完整系统必须包含：

1. USB 输入管理
2. 锂电池充电管理
3. 电源路径管理（Power-Path）
4. 高效 3.3V 稳压
5. 电池保护

---

## 4. TP4056 的工程定位

- 功能：单节锂电池线性充电
- 作用范围：USB → 电池
- **不负责**：
  - 系统供电
  - 电源切换
  - 大电流负载

结论：  
**TP4056 不能单独作为系统电源解决方案。**

---

## 5. 为什么 AMS1117 不适用

- 热损耗高
- 静态电流大
- 锂电满电 4.2V → 3.3V 效率低
- Wi-Fi 峰值下容易掉压

结论：  
**AMS1117 不适合锂电 + ESP32 系统。**

---

## 6. 3.3V 电源的正确选择

### 6.1 LDO（不推荐作为主电源）
仅适用于小负载、无 Wi-Fi 峰值系统。

### 6.2 同步 Buck（推荐）
- 输出 ≥1A
- 输入支持 3.0–4.2V
- 高效率、低发热

---

## 7. WS2812 供电策略

- 与 ESP32 共用 3.3V
- 数据线串 330Ω
- LED 供电端并联 470–1000µF
- 软件限制亮度（30–50%）

---

## 8. Power-Path（电源路径管理）的必要性

Power-Path 负责：
- USB 插入时系统优先用 USB
- USB 拔出时无缝切换到电池
- 不干扰充电过程

缺失 Power-Path 会导致：
- 充电异常
- 电压抖动
- ESP32 重启

---

## 9. 推荐的电源管理芯片（大陆可采购）

### 9.1 TI BQ24072 / BQ24073 / BQ24075
- 充电管理
- Power-Path
- 支持边充边用
- 工程成熟度高

结构：
USB-C → BQ2407x → 系统电源节点 → Buck 3.3V → 负载  
　　　　　　　　　　　　 ↓  
　　　　　　　　　　　 锂电池

---

### 9.2 AXP192 / AXP173
- 集成式 PMIC
- 充电 + Power-Path
- 多路电源管理
- 适合成品设计

---

## 10. USB-C 必要配置

- CC1 → 5.1kΩ → GND
- CC2 → 5.1kΩ → GND

否则部分适配器不输出 5V。

---

## 11. 电池保护

二选一：
- 使用带保护板的锂电池（推荐）
- 自行设计保护电路（复杂，不推荐）

---

## 12. 推荐最终架构（工程结论）

